
function Get-LCID {
	param(
		[string]
		$LanguageTag
	)
	$LCID = @{
		"af"                = "0036"
		"af-ZA"             = "0436"
		"am"                = "005E"
		"am-ET"             = "045E"
		"ar"                = "0001"
		"ar-145"            = "4801"
		"ar-AE"             = "3801"
		"ar-BH"             = "3C01"
		"ar-DZ"             = "1401"
		"ar-EG"             = "0C01"
		"ar-IQ"             = "0801"
		"ar-JO"             = "2C01"
		"ar-KW"             = "3401"
		"ar-LB"             = "3001"
		"ar-LY"             = "1001"
		"ar-MA"             = "1801"
		"ar-OM"             = "2001"
		"ar-Ploc-SA"        = "4401"
		"ar-QA"             = "4001"
		"ar-SA"             = "0401"
		"ar-SY"             = "2801"
		"ar-TN"             = "1C01"
		"ar-YE"             = "2401"
		"arn"               = "007A"
		"arn-CL"            = "047A"
		"as"                = "004D"
		"as-IN"             = "044D"
		"az"                = "002C"
		"az-Cyrl"           = "742C"
		"az-Cyrl-AZ"        = "082C"
		"az-Latn"           = "782C"
		"az-Latn-AZ"        = "042C"
		"ba"                = "006D"
		"ba-RU"             = "046D"
		"be"                = "0023"
		"be-BY"             = "0423"
		"bg"                = "0002"
		"bg-BG"             = "0402"
		"bin"               = "0066"
		"bin-NG"            = "0466"
		"bn"                = "0045"
		"bn-BD"             = "0845"
		"bn-IN"             = "0445"
		"bo"                = "0051"
		"bo-BT"             = "0851"
		"bo-CN"             = "0451"
		"br"                = "007E"
		"br-FR"             = "047E"
		"bs"                = "781A"
		"bs-Cyrl"           = "641A"
		"bs-Cyrl-BA"        = "201A"
		"bs-Latn"           = "681A"
		"bs-Latn-BA"        = "141A"
		"ca"                = "0003"
		"ca-ES"             = "0403"
		"ca-ES-valencia"    = "0803"
		"chr"               = "005C"
		"chr-Cher"          = "7C5C"
		"chr-Cher-US"       = "045C"
		"co"                = "0083"
		"co-FR"             = "0483"
		"cs"                = "0005"
		"cs-CZ"             = "0405"
		"cy"                = "0052"
		"cy-GB"             = "0452"
		"da"                = "0006"
		"da-DK"             = "0406"
		"de"                = "0007"
		"de-AT"             = "0C07"
		"de-CH"             = "0807"
		"de-DE"             = "0407"
		"de-LI"             = "1407"
		"de-LU"             = "1007"
		"dsb"               = "7C2E"
		"dsb-DE"            = "082E"
		"dv"                = "0065"
		"dv-MV"             = "0465"
		"dz-BT"             = "0C51"
		"el"                = "0008"
		"el-GR"             = "0408"
		"en"                = "0009"
		"en-029"            = "2409"
		"en-AE"             = "4C09"
		"en-AU"             = "0C09"
		"en-BH"             = "5009"
		"en-BZ"             = "2809"
		"en-CA"             = "1009"
		"en-EG"             = "5409"
		"en-GB"             = "0809"
		"en-HK"             = "3C09"
		"en-ID"             = "3809"
		"en-IE"             = "1809"
		"en-IN"             = "4009"
		"en-JM"             = "2009"
		"en-JO"             = "5809"
		"en-KW"             = "5C09"
		"en-MY"             = "4409"
		"en-NZ"             = "1409"
		"en-PH"             = "3409"
		"en-SG"             = "4809"
		"en-TR"             = "6009"
		"en-TT"             = "2C09"
		"en-US"             = "0409"
		"en-YE"             = "6409"
		"en-ZA"             = "1C09"
		"en-ZW"             = "3009"
		"es"                = "000A"
		"es-419"            = "580A"
		"es-AR"             = "2C0A"
		"es-BO"             = "400A"
		"es-CL"             = "340A"
		"es-CO"             = "240A"
		"es-CR"             = "140A"
		"es-CU"             = "5C0A"
		"es-DO"             = "1C0A"
		"es-EC"             = "300A"
		"es-ES"             = "0C0A"
		"es-ES_tradnl"      = "040A"
		"es-GT"             = "100A"
		"es-HN"             = "480A"
		"es-MX"             = "080A"
		"es-NI"             = "4C0A"
		"es-PA"             = "180A"
		"es-PE"             = "280A"
		"es-PR"             = "500A"
		"es-PY"             = "3C0A"
		"es-SV"             = "440A"
		"es-US"             = "540A"
		"es-UY"             = "380A"
		"es-VE"             = "200A"
		"et"                = "0025"
		"et-EE"             = "0425"
		"eu"                = "002D"
		"eu-ES"             = "042D"
		"fa"                = "0029"
		"fa-IR"             = "0429"
		"ff"                = "0067"
		"ff-Latn"           = "7C67"
		"ff-Latn-SN"        = "0867"
		"ff-NG, ff-Latn-NG" = "0467"
		"fi"                = "000B"
		"fi-FI"             = "040B"
		"fil"               = "0064"
		"fil-PH"            = "0464"
		"fo"                = "0038"
		"fo-FO"             = "0438"
		"fr"                = "000C"
		"fr-015"            = "E40C"
		"fr-029"            = "1C0C"
		"fr-BE"             = "080C"
		"fr-CA"             = "0C0C"
		"fr-CD"             = "240C"
		"fr-CH"             = "100C"
		"fr-CI"             = "300C"
		"fr-CM"             = "2C0C"
		"fr-FR"             = "040C"
		"fr-HT"             = "3C0C"
		"fr-LU"             = "140C"
		"fr-MA"             = "380C"
		"fr-MC"             = "180C"
		"fr-ML"             = "340C"
		"fr-RE"             = "200C"
		"fr-SN"             = "280C"
		"fy"                = "0062"
		"fy-NL"             = "0462"
		"ga"                = "003C"
		"ga-IE"             = "083C"
		"gd"                = "0091"
		"gd-GB"             = "0491"
		"gl"                = "0056"
		"gl-ES"             = "0456"
		"gn"                = "0074"
		"gn-PY"             = "0474"
		"gsw"               = "0084"
		"gsw-FR"            = "0484"
		"gu"                = "0047"
		"gu-IN"             = "0447"
		"ha"                = "0068"
		"ha-Latn"           = "7C68"
		"ha-Latn-NG"        = "0468"
		"haw"               = "0075"
		"haw-US"            = "0475"
		"he"                = "000D"
		"he-IL"             = "040D"
		"hi"                = "0039"
		"hi-IN"             = "0439"
		"hr"                = "001A"
		"hr-BA"             = "101A"
		"hr-HR"             = "041A"
		"hsb"               = "002E"
		"hsb-DE"            = "042E"
		"hu"                = "000E"
		"hu-HU"             = "040E"
		"hy"                = "002B"
		"hy-AM"             = "042B"
		"ibb"               = "0069"
		"ibb-NG"            = "0469"
		"id"                = "0021"
		"id-ID"             = "0421"
		"ig"                = "0070"
		"ig-NG"             = "0470"
		"ii"                = "0078"
		"ii-CN"             = "0478"
		"is"                = "000F"
		"is-IS"             = "040F"
		"it"                = "0010"
		"it-CH"             = "0810"
		"it-IT"             = "0410"
		"iu"                = "005D"
		"iu-Cans"           = "785D"
		"iu-Cans-CA"        = "045D"
		"iu-Latn"           = "7C5D"
		"iu-Latn-CA"        = "085D"
		"ja"                = "0011"
		"ja-JP"             = "0411"
		"ja-Ploc-JP"        = "0811"
		"ka"                = "0037"
		"ka-GE"             = "0437"
		"khb-Talu-CN"       = "0490"
		"kk"                = "003F"
		"kk-Cyrl"           = "783F"
		"kk-KZ"             = "043F"
		"kk-Latn"           = "7C3F"
		"kk-Latn-KZ"        = "083F"
		"kl"                = "006F"
		"kl-GL"             = "046F"
		"km"                = "0053"
		"km-KH"             = "0453"
		"kn"                = "004B"
		"kn-IN"             = "044B"
		"ko"                = "0012"
		"ko-KR"             = "0412"
		"kok"               = "0057"
		"kok-IN"            = "0457"
		"kr"                = "0071"
		"kr-Latn-NG"        = "0471"
		"ks"                = "0060"
		"ks-Arab"           = "0460"
		"ks-Deva-IN"        = "0860"
		"ku"                = "0092"
		"ku-Arab"           = "7C92"
		"ku-Arab-IQ"        = "0492"
		"ky"                = "0040"
		"ky-KG"             = "0440"
		"la"                = "0076"
		"la-VA"             = "0476"
		"lb"                = "006E"
		"lb-LU"             = "046E"
		"lo"                = "0054"
		"lo-LA"             = "0454"
		"lt"                = "0027"
		"lt-LT"             = "0427"
		"lv"                = "0026"
		"lv-LV"             = "0426"
		"mi"                = "0081"
		"mi-NZ"             = "0481"
		"mk"                = "002F"
		"mk-MK"             = "042F"
		"ml"                = "004C"
		"ml-IN"             = "044C"
		"mn"                = "0050"
		"mn-Cyrl"           = "7850"
		"mn-MN"             = "0450"
		"mn-Mong"           = "7C50"
		"mn-Mong-CN"        = "0850"
		"mn-Mong-MN"        = "0C50"
		"mni"               = "0058"
		"mni-IN"            = "0458"
		"moh"               = "007C"
		"moh-CA"            = "047C"
		"mr"                = "004E"
		"mr-IN"             = "044E"
		"ms"                = "003E"
		"ms-BN"             = "083E"
		"ms-MY"             = "043E"
		"mt"                = "003A"
		"mt-MT"             = "043A"
		"my"                = "0055"
		"my-MM"             = "0455"
		"nb"                = "7C14"
		"nb-NO"             = "0414"
		"ne"                = "0061"
		"ne-IN"             = "0861"
		"ne-NP"             = "0461"
		"nl"                = "0013"
		"nl-BE"             = "0813"
		"nl-NL"             = "0413"
		"nn"                = "7814"
		"nn-NO"             = "0814"
		"no"                = "0014"
		"nso"               = "006C"
		"nso-ZA"            = "046C"
		"oc"                = "0082"
		"oc-FR"             = "0482"
		"om"                = "0072"
		"om-ET"             = "0472"
		"or"                = "0048"
		"or-IN"             = "0448"
		"pa"                = "0046"
		"pa-Arab"           = "7C46"
		"pa-Arab-PK"        = "0846"
		"pa-IN"             = "0446"
		"pap"               = "0079"
		"pap-029"           = "0479"
		"pl"                = "0015"
		"pl-PL"             = "0415"
		"plt-MG"            = "048D"
		"prs"               = "008C"
		"prs-AF"            = "048C"
		"ps"                = "0063"
		"ps-AF"             = "0463"
		"pt"                = "0016"
		"pt-BR"             = "0416"
		"pt-PT"             = "0816"
		"qps-ploc"          = "0501"
		"qps-ploca"         = "05FE"
		"qps-plocm"         = "09FF"
		"quc"               = "0093"
		"quc-CO"            = "0493"
		"qut"               = "0086"
		"qut-GT"            = "0486"
		"quz"               = "006B"
		"quz-BO"            = "046B"
		"quz-EC"            = "086B"
		"quz-PE"            = "0C6b"
		"rm"                = "0017"
		"rm-CH"             = "0417"
		"ro"                = "0018"
		"ro-MD"             = "0818"
		"ro-RO"             = "0418"
		"ru"                = "0019"
		"ru-MD"             = "0819"
		"ru-RU"             = "0419"
		"rw"                = "0087"
		"rw-RW"             = "0487"
		"sa"                = "004F"
		"sa-IN"             = "044F"
		"sah"               = "0085"
		"sah-RU"            = "0485"
		"sd"                = "0059"
		"sd-Arab"           = "7C59"
		"sd-Arab-PK"        = "0859"
		"sd-Deva-IN"        = "0459"
		"se"                = "003B"
		"se-FI"             = "0C3B"
		"se-NO"             = "043B"
		"se-SE"             = "083B"
		"si"                = "005B"
		"si-LK"             = "045B"
		"sk"                = "001B"
		"sk-SK"             = "041B"
		"sl"                = "0024"
		"sl-SI"             = "0424"
		"sma"               = "783B"
		"sma-NO"            = "183B"
		"sma-SE"            = "1C3B"
		"smj"               = "7C3B"
		"smj-NO"            = "103B"
		"smj-SE"            = "143B"
		"smn"               = "703B"
		"smn-FI"            = "243B"
		"sms"               = "743B"
		"sms-FI"            = "203B"
		"so"                = "0077"
		"so-SO"             = "0477"
		"sq"                = "001C"
		"sq-AL"             = "041C"
		"sr"                = "7C1A"
		"sr-Cyrl"           = "6C1A"
		"sr-Cyrl-BA"        = "1C1A"
		"sr-Cyrl-CS"        = "0C1A"
		"sr-Cyrl-ME"        = "301A"
		"sr-Cyrl-RS"        = "281A"
		"sr-Latn"           = "701A"
		"sr-Latn-BA"        = "181A"
		"sr-Latn-CS"        = "081A"
		"sr-Latn-ME"        = "2C1A"
		"sr-Latn-RS"        = "241A"
		"st"                = "0030"
		"st-ZA"             = "0430"
		"sv"                = "001D"
		"sv-FI"             = "081D"
		"sv-SE"             = "041D"
		"sw"                = "0041"
		"sw-KE"             = "0441"
		"syr"               = "005A"
		"syr-SY"            = "045A"
		"ta"                = "0049"
		"ta-IN"             = "0449"
		"ta-LK"             = "0849"
		"tdd-Tale-CN"       = "048F"
		"te"                = "004A"
		"te-IN"             = "044A"
		"tg"                = "0028"
		"tg-Cyrl"           = "7C28"
		"tg-Cyrl-TJ"        = "0428"
		"th"                = "001E"
		"th-TH"             = "041E"
		"ti"                = "0073"
		"ti-ER"             = "0873"
		"ti-ET"             = "0473"
		"tk"                = "0042"
		"tk-TM"             = "0442"
		"tmz-MA"            = "0C5F"
		"tn"                = "0032"
		"tn-BW"             = "0832"
		"tn-ZA"             = "0432"
		"tr"                = "001F"
		"tr-TR"             = "041F"
		"ts"                = "0031"
		"ts-ZA"             = "0431"
		"tt"                = "0044"
		"tt-RU"             = "0444"
		"tzm"               = "005F"
		"tzm-Arab-MA"       = "045F"
		"tzm-Latn"          = "7C5F"
		"tzm-Latn-DZ"       = "085F"
		"tzm-Tfng"          = "785F"
		"tzm-Tfng-MA"       = "105F"
		"ug"                = "0080"
		"ug-CN"             = "0480"
		"uk"                = "0022"
		"uk-UA"             = "0422"
		"ur"                = "0020"
		"ur-IN"             = "0820"
		"ur-PK"             = "0420"
		"uz"                = "0043"
		"uz-Cyrl"           = "7843"
		"uz-Cyrl-UZ"        = "0843"
		"uz-Latn"           = "7C43"
		"uz-Latn-UZ"        = "0443"
		"ve"                = "0033"
		"ve-ZA"             = "0433"
		"vi"                = "002A"
		"vi-VN"             = "042A"
		"wo"                = "0088"
		"wo-SN"             = "0488"
		"xh"                = "0034"
		"xh-ZA"             = "0434"
		"yi"                = "003D"
		"yi-001"            = "043D"
		"yo"                = "006A"
		"yo-NG"             = "046A"
		"zh"                = "7804"
		"zh-CN"             = "0804"
		"zh-HK"             = "0C04"
		"zh-Hans"           = "0004"
		"zh-Hant"           = "7C04"
		"zh-MO"             = "1404"
		"zh-SG"             = "1004"
		"zh-TW"             = "0404"
		"zh-yue-HK"         = "048E"
		"zu"                = "0035"
		"zu-ZA"             = "0435"
	}

	if ([string]::IsNullOrWhiteSpace($LanguageTag)) {
		return $LCID
	} else {
		foreach ($key in $LCID.Keys) {
			if ($key -eq $LanguageTag) {
				return $data[$key]
			}
		}
	}
}

function get-KeyboardID {
	$kbLayout = @(
		[pscustomobject]@{
			Letra           = 'A'
			Distribucion    = "España"
			Verificacion    = "La arroba está en la tecla del número 2"
			Nombre          = "Español"
			InputMethodTips = "0000040A"
		},
		[pscustomobject]@{
			Letra           = "B"
			Distribucion    = "Latinoamérica"
			Verificacion    = "La arroba esta en la tecla Q"
			Nombre          = "Latinoamericano"
			InputMethodTips = "0000080A"
		},
		[pscustomobject]@{
			Letra           = "C"
			Distribucion    = "Ingles EEUU"
			Verificacion    = "Sin `"Ñ`""
			Nombre          = "Estados Unidos"
			InputMethodTips = "00000409"
		},
		[pscustomobject]@{
			Letra           = "D"
			Distribucion    = "Ingles EEUU - Internacional"
			Verificacion    = "Sin `"Ñ`" con ALT GR escribe tildes"
			Nombre          = "Estados Unidos Internacional"
			InputMethodTips = "00020409"
		},
		[pscustomobject]@{
			Letra           = "E"
			Distribucion    = "UK (British)"
			Verificacion    = "La arroba esta a la izq de la virgulilla"
			Nombre          = "Reino Unido (Extendido)"
			InputMethodTips = "00000809"
		}
	)
	$kbLayout | Select-Object Letra, @{label = " Distribución"; expression = { $_. Distribucion } }, @{label = " Verificación"; expression = { $_. Verificacion } } , Nombre | Out-Host
	$options = ($kbLayout | ForEach-Object { $_.Letra })
	$kbSel = Get-UserChoice -text ("Selecciona la configuración de teclado del computador: ") -Options $options
	$kbLayout | ForEach-Object {
		if ($_.Letra -iLike $kbSel) {
			$kbSel = $_.InputMethodTips
		}
	}
	return $kbSel
}
